// ==========================================================
// Components
// ==========================================================


// Settings
@buttonDefaultShadow: 0 1px 0 rgba(0,0,0,0.07);
@space:      round(@margin, 1);
@space-xs:   round(@margin/3, 1);
@space-s:    round(@margin/2, 1);
@space-l:    round(@margin*2, 1);
@space-xl:   round(@margin*3, 1);


// Cells
.atk-cells {
    display:table;
    width: 100%;
    >.atk-cell {
        display: table-cell;
        vertical-align: middle;
    }
    &[class*=atk-move] {
        width: auto;
    }
}
.atk-cells-group {
    display: table;
    >.atk-cells {
        display: table-row;
    }
}
.atk-cells-table {
    display: table;
    .atk-cells-group {
        display: table-row-group;
    }
    >.atk-cells {
        display: table-row;
    }
}
[data-cells*=justified] {
    table-layout: fixed;
}
[data-cells*=spacing] {
    &.atk-cells>.atk-cell,
    &.atk-cells-group>.atk-cells>.atk-cell {
        padding-left: @space;
        padding-right: @space;
        &:first-child {
            padding-left: 0;
        }
        &:last-child {
            padding-right: 0;
        }
    }
}
[data-cells*=spacing-xl] {
    &.atk-cells>.atk-cell,
    &.atk-cells-group>.atk-cells>.atk-cell {
        padding-left: @space-xl;
        padding-right: @space-xl;
    }
}
[data-cells*=spacing-l] {
    &.atk-cells>.atk-cell,
    &.atk-cells-group>.atk-cells>.atk-cell {
        padding-left: @space-l;
        padding-right: @space-l;
    }
}
[data-cells*=spacing-s] {
    &.atk-cells>.atk-cell,
    &.atk-cells-group>.atk-cells>.atk-cell {
        padding-left: @space-s;
        padding-right: @space-s;
    }
}
[data-cells*=spacing-xs] {
    &.atk-cells>.atk-cell,
    &.atk-cells-group>.atk-cells>.atk-cell {
        padding-left: @space-xs;
        padding-right: @space-xs;
    }
}

// Lister
*[class*=atk-lister] {
    > * {
        padding-bottom: @margin;
        + * {
            border-top: 1px solid @borderDisabled;
            padding-top: @margin;
        }
        &:last-child:not([class*=atk-padding]) {
            padding-bottom: 0 !important;
        }
    }
    &.atk-lister-xsmall {
        > * {
            padding-bottom: @margin/3;
            + * {
                padding-top: @margin/3;
            }
        }
    }
    &.atk-lister-small {
        > * {
            padding-bottom: @margin/2;
            + * {
                padding-top: @margin/2;
            }
        }
    }
    &.atk-lister-large {
        > * {
            padding-bottom: @margin*2;
            + * {
                padding-top: @margin*2;
            }
        }
    }
    &.atk-lister-nomargin {
        > *:not([class*=atk-padding]) {
            padding-bottom: 0;
            + *:not([class*=atk-padding]) {
                padding-top: 0;
            }
        }
    }
}

// Buttons
.createButton() {
    .border-radius(@cornerRadius);
    border-style: solid;
    border-width: 1px;
    display: inline-block;
    font-weight: bold;
    line-height: @bodyBaseline;
    padding: (0.5em * @baselineDestroyer) (1em * @baselineDestroyer);
    text-align: center;
    white-space: nowrap;
}
a, button, input {
    &[class*=atk-button] {
        .createButton;
    }
}
.ui-button {
    .createButton;
}
[class*=atk-button] {
    &:not([class*=atk-padding]) {
        &.atk-button-xsmall {
            padding: (0.12em * @baselineDestroyer) (0.25em * @baselineDestroyer);
        }
        &.atk-button-small {
            padding: (0.25em * @baselineDestroyer) (0.5em * @baselineDestroyer);
        }
        &.atk-button-large {
            padding: (0.75em * @baselineDestroyer) (1.5em * @baselineDestroyer);
        }
        &.atk-button-xlarge {
            padding: (1em * @baselineDestroyer) (2em * @baselineDestroyer);
        }
    }
    .atk-buttonset>& {
        .border-radius(0);
        &:first-child {
            .border-left-radius(@cornerRadius);
        }
        &:last-child {
            .border-right-radius(@cornerRadius);
        }
        + * {
            border-left: none;
        }
    }
}
.atk-button-blank {
    background: none !important;
    border-color: transparent !important;
    box-shadow: none !important;
}
ul[class*=atk-menu] {
    &:not(.atk-cells) {
        display: inline-block;
    }
    list-style-type: none;
    margin-bottom: 0;
    margin-right: 0;
    margin-top: 0;
    padding: 0;
    white-space: nowrap;
    >li {
        .clear-fix;
        display: inline-block;
        position: relative;
        >a[class*='atk-button'] {
            .box-sizing(content-box);
            min-width: 1em;
        }
            .atk-label {
                &[class*='icon']:before {
                    margin: 0;
                }
                &.atk-shape-circle {
                    display: inline-block;
                    padding-top: 0;
                    padding-bottom: 0;
                    text-align: center;
                    width: 1em * @bodyBaseline;
                }
            }
        >a {
            display: inline-block;
            white-space: nowrap;
        }
        *[class*=atk-menu]:not(.atk-menu-separated) {
            .clear-ul;
            display: none;
            z-index: 99;
            &[data-menu-position="right"] {
                left: auto !important;
                right: 0;
            }
        }
        &:hover {
            *[class*=atk-menu] {
                display: block;
            }
            &[class*=atk-swatch] {
                >a[class*=atk-swatch] {
                    background: none;
                }
            }
        }
        &.atk-menu-active {
            >a, >a:hover {
                .colorCheck(@menuActive);
                background: @menuActive;
                cursor: default;
            }
        }
    }
    &:not([class*=atk-actions])>li {
        margin-left: 0;
    }
    &.atk-menu-horizontal {
        >li {
            >a {
                *[class*='icon']:before {
                    margin: 0;
                }
            }
            *[class*=atk-menu]:not(.atk-menu-separated) {
                .position(@t:100%, @l:0);
                min-width: 100%;
                &.atk-menu-right {
                    left: auto;
                    right: 0;
                }
            }
        }
    }
    &.atk-menu-vertical {
        display: block;
        >li {
            display: block;
            a {
                display: block;
                float: none;
                &[class*=atk-button] {
                    text-align: left;
                }
            }
            *[class*=atk-menu]:not(.atk-menu-separated) {
                .position(@t:0, @l:100%);
            }
        }
    }
}

// Box
*[class*=atk-box] {
    &, .ui-tabs &.ui-tabs-panel.ui-widget-content {
        .border-radius(@cornerRadius);
        border: 1px solid transparent;
        display: block;
        margin-bottom: @margin;
        &:not([class*=atk-padding]):not([data-padding]) {
            padding: @margin;
            &.atk-box-xsmall {
                padding: @margin/2;
            }
            &.atk-box-small {
                padding: @margin/1.5;
            }
            &.atk-box-large {
                padding: @margin*1.5;
            }
            &.atk-box-xlarge {
                padding: @margin*2;
            }
        }
        &:last-child {
            margin-bottom: 0;
        }
    }
}

// Label
.atk-label {
    .border-radius(@cornerRadius);
    display: inline;
    padding: (0.2em * @baselineDestroyer) (0.5em * @baselineDestroyer);
    white-space: nowrap;
}

// Grid
.atk-grid.atk-row {
    margin-left: -@margin  * @baselineDestroyer;
    margin-top: -@margin  * @baselineDestroyer;
    *[class^=atk-col] {
        border-left-width: @margin  * @baselineDestroyer;
        margin-top: @margin  * @baselineDestroyer;
    }
    &.atk-grid-gutter-xsmall {
        margin-left: (-@margin  * @baselineDestroyer)/4;
        margin-top: (-@margin  * @baselineDestroyer)/4;
        *[class^=atk-col] {
            border-left-width: (@margin  * @baselineDestroyer)/4;
            margin-top: (@margin  * @baselineDestroyer)/4;
        }
    }
    &.atk-grid-gutter-small {
        margin-left: (-@margin  * @baselineDestroyer)/2;
        margin-top: (-@margin  * @baselineDestroyer)/2;
        *[class^=atk-col] {
            border-left-width: (@margin  * @baselineDestroyer)/2;
            margin-top: (@margin  * @baselineDestroyer)/2;
        }
    }
    &.atk-grid-gutter-large {
        margin-left: (-@margin  * @baselineDestroyer)*2;
        margin-top: (-@margin  * @baselineDestroyer)*2;
        *[class^=atk-col] {
            border-left-width: (@margin  * @baselineDestroyer)*2;
            margin-top: (@margin  * @baselineDestroyer)*2;
        }
    }
}

// Helpers
.atk-inline {
    display: inline-block !important;
}
.atk-block {
    display: block !important;
}
.atk-jackscrew, .atk-expand {
    width: 100% !important;
}
.atk-width-auto {
    width: auto !important;
}
.atk-clear-fix {
    .clear-fix;
}

// Positioning
.atk-move-left {
    float: left;
}
.atk-move-center {
    float: none !important;
    margin-left: auto !important;
    margin-right: auto !important;
    &.atk-button {
        display: block;
    }
}
.atk-move-right {
    float: right;
}
.atk-align-left {
    text-align: left !important;
}
.atk-align-right {
    text-align: right !important;
}
.atk-align-center {
    text-align: center !important;
}

.atk-cells-group.atk-valign-top>.atk-cells>.atk-cell,
.atk-valign-top,
.atk-cells.atk-valign-top>.atk-cell {
    vertical-align: top !important;
}
.atk-cells-group.atk-valign-middle>.atk-cells>.atk-cell,
.atk-valign-middle,
.atk-valign-middle.atk-cells>.atk-cell {
    vertical-align: middle !important;
}
.atk-cells-group.atk-valign-baseline>.atk-cells>.atk-cell,
.atk-valign-baseline,
.atk-valign-baseline.atk-cells>.atk-cell {
    vertical-align: baseline !important;
}
.atk-cells-group.atk-valign-bottom>.atk-cells>.atk-cell,
.atk-valign-bottom,
.atk-valign-bottom.atk-cells>.atk-cell {
    vertical-align: bottom !important;
}


// ==========================================================
// Spacing
// ==========================================================

.createSpace(@property:padding) {
    @data-property: ~'data-@{property}';

    // All
    &[@{data-property}*='all'] {
        @{property}: @space;
    }
    &[@{data-property}*='all-xs'] {
        @{property}: @space-xs;
    }
    &[@{data-property}*='all-s'] {
        @{property}: @space-s;
    }
    &[@{data-property}*='all-l'] {
        @{property}: @space-l;
    }
    &[@{data-property}*='all-xl'] {
        @{property}: @space-xl;
    }

    // Bottom
    &[@{data-property}*='bottom'] {
        @{property}-bottom: @space;
    }
    &[@{data-property}*='bottom-xs'] {
        @{property}-bottom: @space-xs;
    }
    &[@{data-property}*='bottom-s'] {
        @{property}-bottom: @space-s;
    }
    &[@{data-property}*='bottom-l'] {
        @{property}-bottom: @space-l;
    }
    &[@{data-property}*='bottom-xl'] {
        @{property}-bottom: @space-xl;
    }

    // Left
    &[@{data-property}*='left'] {
        @{property}-left: @space;
    }
    &[@{data-property}*='left-xs'] {
        @{property}-left: @space-xs;
    }
    &[@{data-property}*='left-s'] {
        @{property}-left: @space-s;
    }
    &[@{data-property}*='left-l'] {
        @{property}-left: @space-l;
    }
    &[@{data-property}*='left-xl'] {
        @{property}-left: @space-xl;
    }

    // Right
    &[@{data-property}*='right'] {
        @{property}-right: @space;
    }
    &[@{data-property}*='right-xs'] {
        @{property}-right: @space-xs;
    }
    &[@{data-property}*='right-s'] {
        @{property}-right: @space-s;
    }
    &[@{data-property}*='right-l'] {
        @{property}-right: @space-l;
    }
    &[@{data-property}*='right-xl'] {
        @{property}-right: @space-xl;
    }

    // Top
    &[@{data-property}*='top'] {
        @{property}-top: @space;
    }
    &[@{data-property}*='top-xs'] {
        @{property}-top: @space-xs;
    }
    &[@{data-property}*='top-s'] {
        @{property}-top: @space-s;
    }
    &[@{data-property}*='top-l'] {
        @{property}-top: @space-l;
    }
    &[@{data-property}*='top-xl'] {
        @{property}-top: @space-xl;
    }

    // Reset
    &[@{data-property}*='reset-all'] {
        @{property}: 0;
    }
    &[@{data-property}*='reset-bottom'] {
        @{property}-bottom: 0;
    }
    &[@{data-property}*='reset-left'] {
        @{property}-left: 0;
    }
    &[@{data-property}*='reset-reset'] {
        @{property}-right: 0;
    }
    &[@{data-property}*='reset-top'] {
        @{property}-top: 0;
    }
}
.createSpace(padding);
.createSpace(margin);

.atk-space-xsmall {
    height: @space-xs
}
.atk-space-small {
    height: @space-s;
}
.atk-space {
    height: @space;
}
.atk-space-large {
    height: @space-l;
}
.atk-space-xlarge {
    height: @space-xl;
}


// ==========================================================
// Colors
// ==========================================================

.colorCheck (@a,@b:auto) when (luma(@a) >= @swatchText) {
  color: multiply(@bodyColor, @a);
  & when (@b = important) {
    color: multiply(@a, @bodyColor) !important;
  }
}
.colorCheck (@a,@b:auto) when (luma(@a) < @swatchText) {
  color: white;
  & when (@b = important) {
    color: white !important;
  }
}
.backgroundColorCheck (@a) when (luma(@a) >= @swatchText) {
  background-color: darken(@a, @hoverIntensity);
}
.backgroundColorCheck (@a) when (luma(@a) < @swatchText) {
  background-color: lighten(@a, @hoverIntensity);
}
.borderColorCheck (@a) when (luma(@a) >= @swatchText) {
  border-color: white;
}
.borderColorCheck (@a) when (luma(@a) < @swatchText) {
  border-color: black;
}


// Effects
*[class*=atk-effect] {
    &, &[class*='atk-button'] {
        &.atk-effect-danger {
            color: @effectDanger;
        }
        &.atk-effect-warning {
            color: @effectWarning;
        }
        &.atk-effect-success {
            color: @effectSuccess;
        }
        &.atk-effect-info {
            color: @effectInfo;
        }
    }
    &.atk-label, &[class*=atk-box] {
        // color: @bodyColor;
        &.atk-effect-danger {
            // .colorCheck(@color);
            @color: tint(@effectDanger, 90%);
            // color: contrast(@color, black, white, 50%);
            background-color: @color;
            border-color: @color;
            &, h1, h2, h3, h4, h5, h6 {
                color: multiply(@effectDanger, #999);
            }
        }
        &.atk-effect-warning {
            // .colorCheck(@color);
            @color: tint(@effectWarning, 90%);
            background-color: @color;
            border-color: @color;
            &, h1, h2, h3, h4, h5, h6 {
                color: multiply(@effectWarning, #999);
            }
        }
        &.atk-effect-success {
            // .colorCheck(@color);
            @color: tint(@effectSuccess, 90%);
            background: @color;
            border-color: @color;
            &, h1, h2, h3, h4, h5, h6 {
                color: multiply(@effectSuccess, #999);
            }
        }
        &.atk-effect-info {
            // .colorCheck(@color);
            @color: tint(@effectInfo, 90%);
            background-color: @color;
            border-color: @color;
            &, h1, h2, h3, h4, h5, h6 {
                color: multiply(@effectInfo, #999);
            }
        }
    }
    &.atk-effect-danger {
        input[type="text"],
        input[type="url"],
        input[type="email"],
        input[type="password"],
        input[type="search"],
        input[type="number"],
        input[type="date"],
        input[type="month"],
        input[type="week"],
        input[type="time"],
        input[type="datetime"],
        input[type="datetime-local"],
        input[type="tel"],
        textarea,
        .ui-selectmenu-button  {
            border-color: @effectDanger;
        }
    }
}
.atk-disabled {
    .opacity(50);
    pointer-events: none;
}


// ==========================================================
// Swatches
// ==========================================================

.createSmartSwatch(@sName, @sFill:#fff, @sText:auto, @sHeading:auto, @sComment:auto, @sLink:auto, @sBorderIntensity: 3%, @sBorder:darken(@sFill, @sBorderIntensity*2), @sBorderDisabled:darken(@sFill, @sBorderIntensity), @sBorderActive:darken(@sFill, @sBorderIntensity*4), @sBorderOverlay:darken(@sFill, @sBorderIntensity*5)) {
    .createTextColors() {
        & when (@sHeading = auto) {
            h1, h2, h3, h4, h5, h6 {
                .colorCheck(@sFill);
            }
        }
        & when not (@sHeading = auto) {
            h1, h2, h3, h4, h5, h6 {
                color: @sHeading;
            }
        }
        & when (@sComment = auto) {
            .atk-comment {
                .colorCheck(@sFill);
            }
        }
        & when not (@sComment = auto) {
            .atk-comment {
                color: @sComment;
            }
        }
        & when (@sLink = auto) {
            a:not([class*=atk-button]) {
                .colorCheck(@sFill);
            }
        }
        & when not (@sLink = auto) {
            a:not([class*=atk-button]) {
                color: @sLink;
            }
        }
        & when (@sText = auto) {
            .colorCheck(@sFill);
        }
        & when not (@sText = auto) {
            color: @sText;
        }
        & when (@sBorder = auto) {
            border-color: darken(@sFill, 6%);
        }
        hr {
            border-color: @sBorder;
        }
        &[data-border*=static] {
            border-color: @sBorder;
        }
        &[data-border*=disabled] {
            border-color: @sBorderDisabled;
        }
        &[data-border*=active] {
            border-color: @sBorderActive;
        }
        &[data-border*=overlay] {
            border-color: @sBorderOverlay;
        }
    }
    .createWidgetColors() {
        body &[class*=atk-box] {
            background-color: @sFill;
            border-color: @sBorder;
        }
        body &[class*=atk-button],
        .ui-state-default, .ui-widget-content .ui-state-default {
            background-color: @sFill;
            border-color: @sBorderActive;
            .colorCheck(@sFill);
            &:hover {
                background-color: darken(@sFill,2%);
                border-color: darken(@sBorderActive,2%);
            }
            &[data-border*=outline] {
                background: transparent;
                border-color: @sFill;   
                color: @sFill;
                &:hover {
                    .colorCheck(@sFill);
                    background-color: @sFill;
                }
            }
        }
        hr {
            border-color: @sBorder;
        }
        &.atk-popover, &.atk-popover[class*=atk-box] {
            border-color: @sBorderOverlay;
            .atk-popover-arrow:before {
                background: @sFill;
                border-color: @sBorderOverlay;
            }
        }
    }
    & when (@sName = default) {
        .createWidgetColors();
        body {
            color: @sText;
        }
        body,
        *[class*=atk-swatch] *[class*=atk-box]:not([class*=atk-swatch]),
        *[class*=atk-box]:not([class*=atk-swatch]) *[class*=atk-swatch] *[class*=atk-box]:not([class*=atk-swatch]) {
            color: @sText;
            .createTextColors();
        }
    }
    & when not (@sName = default) {
        .@{sName} {
            background-color: @sFill;
            color: @sText;
            .createWidgetColors();
            body &, *[class*=atk-box]:not([class*=swatch]) & {
                .createTextColors();
            }
            &[class*=icon] {
                background: none;
                color: @sFill !important;
            }
        }
    }
}


// ==========================================================
// Visuals
// ==========================================================

// Shapes
[data-shape*='rectangle'] {
    &, input& {
        border-radius: 0;
    }
}
[data-shape*='rounded'] {
    &, img&, input&  {
        .border-radius(@cornerRadius);
    }
}
[data-shape*='rounded-top'] {
     &, img&, input&  {
        .border-radius(0);
        .border-top-radius(@cornerRadius);
    }
}
[data-shape*='rounded-bottom'] {
     &, img&, input&  {
        .border-radius(0);
        .border-bottom-radius(@cornerRadius);
    }
}
[data-shape*='rounded-left'] {
     &, img&, input&  {
        .border-radius(0);
        .border-left-radius(@cornerRadius);
    }
}
[data-shape*='rounded-right'] {
     &, img&, input&  {
        .border-radius(0);
        .border-right-radius(@cornerRadius);
    }
}
[data-shape*='rounded-top-left'] {
     &, img&, input&  {
        .border-radius(0);
        .border-top-left-radius(@cornerRadius);
    }
}
[data-shape*='rounded-top-right'] {
     &, img&, input&  {
        .border-radius(0);
        .border-top-right-radius(@cornerRadius);
    }
}
[data-shape*='rounded-bottom-left'] {
     &, img&, input&  {
        .border-radius(0);
        .border-bottom-left-radius(@cornerRadius);
    }
}
[data-shape*='rounded-bottom-right'] {
     &, img&, input&  {
        .border-radius(0);
        .border-bottom-right-radius(@cornerRadius);
    }
}
[data-shape*='circle'] {
    display: inline-block;
    &, img&, a&[class*='atk-button'], button&[class*='atk-button'], input&[class*='atk-button'], a&.ui-button, button&.ui-button, input&.ui-button {
        .border-radius(50%);
    }
}

// Borders {
[data-border*=outline] {
    &, &[class*=atk-button], &[class*=swatch] {
        background-color: transparent;
    }
}
[data-border] {
    border-style: solid;
}
[data-border*=thin] {
    border-width: 0.5px !important;
}
[data-border*=thick] {
    border-width: 2px !important;
}
[data-border*=bottom] {
  border-right-width: 1px;
}
[data-border*=left] {
  border-left-width: 1px;
}
[data-border*=right] {
  border-right-width: 1px;
}
[data-border*=top] {
  border-top-width: 1px;
}

// Item List
[data-items]>* + * {
    margin-left: @space;
}
[data-items*=spacing-xs]>* + * {
    margin-left: @space-xs;
}
[data-items*=spacing-s]>* + * {
    margin-left: @space-s;
}
[data-items*=spacing-l]>* + * {
    margin-left: @space-l;
}
[data-items*=spacing-xl]>* + * {
    margin-left: @space-xl;
}